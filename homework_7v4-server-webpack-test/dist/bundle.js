(()=>{"use strict";class t{constructor(){this.popUpDiv=e("div","container-popUp"),this.popUpForm=e("form","form-popUp"),this.popCancelButton=e("button","pop-cancel-button"),this.popCancelButton.textContent="X",this.popCancelButton.addEventListener("click",(t=>{t.preventDefault(),this.popUpDiv.remove()})),this.popUpApplyButton=e("button","pop-add-button"),this.popUpApplyButton.textContent="CHANGE",this.h2=e("h2","h2-text"),this.popUpText=e("input","input-text"),this.popUpText.setAttribute("type","text"),this.popUpDiv.append(this.popUpForm),document.body.prepend(this.popUpDiv),this.popUpText.focus(),document.addEventListener("keyup",(t=>{27===t.keyCode&&this.popUpDiv.remove()}))}}function e(t,e){const n=document.createElement(`${t}`);return n.classList.add(`${e}`),n}const n=document.querySelector(".add-task-button"),p=document.querySelector(".task-input"),o=document.querySelector(".task-date"),s=document.querySelector(".task-list"),a=document.querySelector(".task-category"),i=c("span","task-category");function c(t,e){const n=document.createElement(`${t}`);return n.classList.add(`${e}`),n}function d(t){let e=new Date;t.value=`${e.getFullYear()}-${String(101+e.getMonth()).slice(1)}-${String(100+e.getDate()).slice(1)}`}function l(t,e,n,p){const o=c("div","div-list-element");return x(o,e,p),o.append(n),function(t,e){const n=c("span","task-category");e.category&&(n.textContent=`${e.category}`),t.append(n)}(o,p),t.append(o),v(t,n,p),k(t,p),t}fetch("https://todoappexamplejs.herokuapp.com/items.json").then((t=>{clearInterval(window.myInterval),loading.remove(),delete window.myInterval})),function(){let t=0;loading&&(window.myInterval=setInterval((()=>{t++,loading.append("."),loading.prepend("."),t%4==0&&(loading.innerText="LOADING",t=0)}),1e3))}();class r extends t{constructor(t){super(),this.h2.textContent="РЕДАКТИРОВАТЬ ЗАДАЧУ: ",this.popUpText.value=`${t}`,this.popUpDate=c("input","input-date"),this.popUpDate.setAttribute("type","date"),d(this.popUpDate),this.popUpForm.append(this.popCancelButton,this.h2,this.popUpDate,this.popUpText,this.popUpApplyButton)}}class u extends t{constructor(){super(),this.h2.textContent="ВВЕДИТЕ СВОЮ КАТЕГОРИЮ: ",this.popUpForm.append(this.popCancelButton,this.h2,this.popUpText,this.popUpApplyButton)}}function h(t){fetch("https://todoappexamplejs.herokuapp.com/items.json").then((t=>t.json())).then((e=>{for(let n of e){const e=c("li","task-list-element"),p=c("span","task-text");p.textContent=n.title,l(e,t,p,n),s.append(e),n.done&&(e.querySelector(".div-list-element").classList.add("task-checked"),e.querySelector(".task-checkbox").checked=!0),m(e,n.category)}}))}function m(t,e){switch(e){case"обычное":t.querySelector(".div-list-element").classList.add("task-category-regular");break;case"важное":t.querySelector(".div-list-element").classList.add("task-category-main");break;default:t.querySelector(".div-list-element").classList.add("task-category-custom")}return t}function v(t,e,n){const p=c("button","edit-task-button"),o=c("span","button-icon"),s=c("span","button-text");s.textContent="EDIT",p.append(o,s),t.append(p),p.addEventListener("click",(()=>function(t,e){let n=t.textContent.slice(0,-22),p=new r(n);p.popUpApplyButton.addEventListener("click",(n=>{n.preventDefault(),t.textContent=`${p.popUpText.value} сделать до ${p.popUpDate.value}`,function(t,e){fetch(`https://todoappexamplejs.herokuapp.com/items/${e.id}`,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({title:t.textContent})})}(t,e),p.popUpDiv.remove()}))}(e,n)))}function k(t,e){const n=c("button","delete-task-button"),p=c("span","button-icon"),o=c("span","button-text");o.textContent="DEL",n.append(p,o),t.append(n),n.addEventListener("click",(()=>{(function(t){return fetch(`https://todoappexamplejs.herokuapp.com/items/${t.id}`,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"}}).then()})(e).then((()=>{t.remove()}))}))}function x(t,e,n){const p=c("input","task-checkbox");p.setAttribute("type","checkbox"),t.prepend(p),p.addEventListener("click",(()=>{!function(t,e,n){let p;e.checked?(t.classList.add("task-checked"),p=!0):(t.classList.remove("task-checked"),p=!1),function(t,e){fetch(`https://todoappexamplejs.herokuapp.com/items/${t.id}`,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({done:e})})}(n,p)}(t,p,n),e.append(t.closest("li"))}))}var y;d(o),h(s),(y=a).addEventListener("change",(()=>{if("своя категория"===y.value){i.textContent="";let t=new u;t.popUpApplyButton.addEventListener("click",(e=>{e.preventDefault(),i.textContent=`${t.popUpText.value}`,t.popUpDiv.remove()}))}return i})),window.addEventListener("resize",(()=>{document.documentElement.clientWidth<767?p.setAttribute("placeholder","TASK MESSAGE"):p.setAttribute("placeholder","")})),n.addEventListener("click",(t=>{t.preventDefault(),function(t,e,n){const p=c("li","task-list-element"),o=c("div","div-list-element"),s=c("span","task-text");var d,l;s.textContent=`${t.value} сделать до ${e.value}`,x(o,n),o.append(s),o.append(i),p.append(o),v(p,s),k(p),n.append(p),m(p,a.value),(d={title:s.textContent,done:!1,category:(l=a,"обычное"===l.value||"важное"===l.value?(i.textContent=`${l.value}`,i.textContent):i.textContent)},fetch("https://todoappexamplejs.herokuapp.com/items.json",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(d)}).then((t=>t.json()))).then((()=>{n.innerHTML="",h(n)}))}(p,o,s),p.value=""}))})();